import{K as w,d as m,t as L,f as y,L as p,e as S,h as R,M as T,v as I,w as P,k as v,r as x,T as i,l as D,N as a,j as c,O as U}from"./index-CS1P21SE.js";import _ from"./index-Dewuwtqz.js";import"./index-Dky04T3y.js";const K=()=>{w();const{t:u}=m(),{getSetting:s}=L(),l=s("system_theme_setting.loginTemplate","default"),{defaultRoute:o}=y(),r=p(),f=S(),g=R(T,{manual:!0,onSuccess(e){r({type:"update-userInfo",payload:{userInfo:e.data}})}}),[b,d,h]=I(P("loginParams")),n=()=>{let e=window.location.hash.includes("?redirect=")?window.location.hash.split("?redirect=")[1]:o;e=="/login"&&(e=o),f.replace(e)};return v("afterLoginSuccess",async(e,t)=>{e!=null&&e.username&&(e!=null&&e.password)?d(window.btoa(encodeURIComponent(JSON.stringify(e)))):h(),i().set(t),await g.runAsync(),await window.$owl.refreshRoutes(),a()&&n()}),x.useEffect(()=>{i().value&&n()},[]),D(()=>{if(a()){let e=u("login.title");const t=s("layout.title");t&&(e=t.replace(/%title%/g,e)),document.title=e}}),(e=>{switch(e){case"amis":return c(U,{});default:return c(_,{})}})(l)};export{K as default};
